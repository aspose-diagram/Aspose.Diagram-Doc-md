+++
title = "Working with User-defined Cells" 
description = "" 
weight = 8047 
+++

Aspose.Diagram for .NET : Working with User-defined Cells  

# Aspose.Diagram for .NET : Working with User-defined Cells


{{< panel title="Contents Summary" style="primary" >}}
*   1 [Read User-defined Cells of the Visio Shapes](#WorkingwithUser-definedCells-ReadUser-definedCellsoftheVisioShapes)
    *   1.1 [Retrieve the User-defined Cells Fields](#WorkingwithUser-definedCells-RetrievetheUser-definedCellsFields)
        *   1.1.1 [Retrieve Cells Programming Sample](#WorkingwithUser-definedCells-RetrieveCellsProgrammingSample)
*   2 [Create User-defined Cell in the ShapeSheet](#WorkingwithUser-definedCells-CreateUser-definedCellintheShapeSheet)
    *   2.1 [Create User-defined Cell](#WorkingwithUser-definedCells-CreateUser-definedCell)
        *   2.1.1 [Create Cell Programming Sample](#WorkingwithUser-definedCells-CreateCellProgrammingSample)
*   3 [Retrieve User-defined Cells from Shapesheet](#WorkingwithUser-definedCells-RetrieveUser-definedCellsfromShapesheet)
    *   3.1 [Retrieve User-defined Cells](#WorkingwithUser-definedCells-RetrieveUser-definedCells)
        *   3.1.1 [Retrieve Cells from Shapesheet Programming Samples](#WorkingwithUser-definedCells-RetrieveCellsfromShapesheetProgrammingSamples)
{{< /panel >}}
 

 

## Read User-defined Cells of the Visio Shapes

Users insert text fields into shapes to display additional information. **User-defined Cells** is the one branch of these fields and this branch uses information entered in the Value cell of the User-defined Cells section in the shape's ShapeSheet. Developers can insert and read all user defined cells using [Aspose.Diagram for .NET API](http://www.aspose.com/.net/diagram-component.aspx).

### Retrieve the User-defined Cells Fields

Users collection exposed by [Shape](http://www.aspose.com/api/net/diagram/aspose.diagram/shape) class supports the `Aspose.Diagram.User` object. This property can be used to read the user defined cells of a Visio shape as available in the User-defined Cells section of the shape's ShapeSheet.  
![](https://docs2.aspose.com/diagram/net/attachments/18350135/18546987.png)

#### Retrieve Cells Programming Sample

The following piece of code allows developers to read the user defined cells fields.

  
This image shows the output after running the above code:  
  
![](https://docs2.aspose.com/diagram/net/attachments/18350135/18546990.png)

## Create User-defined Cell in the ShapeSheet

[Aspose.Diagram for .NET API](http://www.aspose.com/.net/diagram-component.aspx) allows to create user-defined cell in the shapesheet. This example topic describes the way, developers can add as many User.name rows as they need, assign meaningful names to the rows, and set cell values.

### Create User-defined Cell

The `Add` method exposed by the `Users` Collection can be used to create a user-defined cell in the shapesheet. It takes a single parameter.

#### Create Cell Programming Sample

Use the following code example in your .NET application to create user-defined cell in the shapesheet using Aspose.Diagram for .NET.

## Retrieve User-defined Cells from Shapesheet

Aspose.Diagram for .NET API allows to retrieve user-defined cells from shapesheet. This example topic describes the way, developers can retrieve all User.name for all shapes in a drawing.

### Retrieve User-defined Cells

The `NameU`, `Value.Val` and `Prompt.Value` properties exposed by the `User` class can be used to retrieve user-defined cells from shapesheet.

#### Retrieve Cells from Shapesheet Programming Samples

Use the following code in your .NET application to retrieve all user-defined cells from shapesheet using Aspose.Diagram for .NET.

## Attachments:

![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Retrieving shapes information-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547146.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting XForm data-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547145.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting XForm data-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547144.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-XForm-data.001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547143.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-XForm-data.003.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547142.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-XForm-data-004.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546994.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting Line data-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546993.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting Line data-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546996.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Line-data-003.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546995.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Line-data-004.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546998.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting Fill data-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546997.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting Fill data-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547000.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Fill-data-003.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546999.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Fill-data-004.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546986.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Reading shape data-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546985.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Reading shape data-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546988.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Reading user properties-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546987.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Reading user properties-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546990.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Hyperlink.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546989.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Hyperlink2.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546992.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Height-and-Width-001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18546991.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Setting-Height-and-Width-002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547009.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Input.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547010.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Output.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547011.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Connect Sub-shapes of the Groups 001.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547012.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Connect Sub-shapes of the Groups 002.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547013.png) (image/png)  
![](https://docs2.aspose.com/diagram/net/images/icons/bullet_blue.gif) [Select Reroute Options 01.png](https://docs2.aspose.com/diagram/net/attachments/18350135/18547014.png) (image/png)  

